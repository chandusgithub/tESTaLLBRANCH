<template>
    <div>
        <div class="section-header">
            <div class="slds-p-top_xx-small slds-p-left_x-small slds-text-heading_small slds-p-bottom_medium">
                <span><b>Anticipated Bid Cycle for Major Products</b></span>
            </div>
        </div>
    </div>
    <div class="slds-p-top_small  slds-text-align_right slds-text-heading_small">
        <template lwc:if={isEditMode}>

            <lightning-button label="Clear Data" class="clear-data-btn" variant="Neutral" alternative-text="Clear entire table" size="small"
                title="Clear entire table" onclick={deleteAllAnticipatedRows}>
            </lightning-button>
            <template if:true={showConfirmModalAnticipated}>
                <section role="dialog" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header" style="background-color: #ba0517; color: white;">
                            <h2 class="slds-text-heading_medium">Confirmation</h2>
                        </header>
                        <div class="slds-modal__content slds-p-around_medium">
                                <p class="slds-text-heading_small slds-text-align_center slds-p-horizontal_large">
                                    This action will clear all data in the table. Are you sure you want to proceed?
                                </p>
                             <div style="text-align: center;" class="slds-p-top_large">
                            <lightning-button label="Continue" onclick={handleConfirmDeleteAnticipated}>
                            </lightning-button>

                            <lightning-button label="Cancel" onclick={handleCancelDelete} class="slds-m-left_x-small">
                            </lightning-button>
                        </div>
                        </div>
                        
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </template>
        </template>
        <template lwc:else>

            <lightning-button label="Clear Data" class="clear-data-btn" variant="Neutral" disabled alternative-text="Clear entire table"
                size="small" title="Clear entire table" onclick={deleteAllAnticipatedRows}>
            </lightning-button>
        </template>
    </div>
    <div class="slds-p-top_small slds-p-bottom_large">
        <table class="slds-text-body_small slds-table slds-border_left slds-border_right  slds-table--bordered slds-max-medium-table--stacked-horizontal slds-table--resizable-cols">
            <thead class="header-color">
                <tr>
                    <td class="slds-border_right" colspan="4" style ="width:23%"> <b>Product </b></td>
                    <td class="slds-border_right" colspan="4" style ="width:23%"> <b>Incumbent </b></td>
                    <td class="slds-border_right" colspan="4" style ="width:23%"><b> Deal Cycle </b></td>
                    <td colspan="4" style ="width:23%"> <b> Status </b> </td>
                    <td class="slds-border_right" colspan="1" style ="width:8%">
                        <div class="slds-text-align_right" >
                            <template lwc:if={isEditMode}>
                                <lightning-icon icon-name="action:new" data-index={index} alternative-text="Add new row"
                                    size="xx-small" title="Add new row" onclick={addAnticipatedRow}>
                                </lightning-icon>
                            </template>
                            <template lwc:else>
                                <lightning-icon icon-name="action:new" alternative-text="Add new row" size="xx-small"
                                    title="Add new row" class="disabled-icon">
                                </lightning-icon>
                            </template>
                        </div>
                    </td>
                </tr>
            </thead>
            <tbody>
                <template for:each={internalData} for:item="rec" for:index="index">
                    <tr key={rec.id}>
                        <td class="slds-border_right" colspan="4" style ="width:23%">
                            <template if:true={rec.isFixed}>
                                   <!--  {rec.Product__c} -->
                                <lightning-input type="text" name="Product__c" data-index={index} value={rec.Product__c} onchange={handleChange}
                                    max-length="255" disabled>
                                </lightning-input>
                                </template>
                            <template if:false={rec.isFixed}>
                            <template lwc:if={isEditMode}>
                                    <lightning-input type="text" name="Product__c" data-index={index}
                                        value={rec.Product__c} onchange={handleChange} max-length="255">
                                    </lightning-input>
                                <!--<lightning-input type="text" name="Product__c" data-index={index}
                                        value={rec.Product__c} onchange={handleChange} max-length="255"></lightning-input>-->
                            </template>
                            <template lwc:else>
                                <lightning-formatted-text style="word-wrap: break-word; white-space: normal;" value={rec.Product__c}></lightning-formatted-text>
                            </template>
                            </template>        
                              </td>
                        <td class="slds-border_right" colspan="4" style ="width:23%">
                            <template if:true={rec.isFixed}>
                                    <!-- {rec.Incumbent__c} -->
                                    <lightning-input type="text" name="Incumbent__c" data-index={index} value={rec.Incumbent__c} onchange={handleChange}
                                    max-length="255" disabled>
                                </lightning-input>
                                </template>
                                <template if:false={rec.isFixed}>
                            <template lwc:if={isEditMode}>
                                <lightning-input type="text" name="Incumbent__c" data-index={index}
                                        value={rec.Incumbent__c} onchange={handleChange} max-length="255" >
                                    </lightning-input>
                                <!--<lightning-input type="text" name="Product__c" data-index={index}
                                        value={rec.Product__c} onchange={handleChange} max-length="255"></lightning-input>-->
                            </template>
                            <template lwc:else>
                                <lightning-formatted-text style="word-wrap: break-word; white-space: normal;" value={rec.Incumbent__c}></lightning-formatted-text>
                            </template>
                                </template>
                        </td>
                        <td class="slds-border_right" colspan="4" style ="width:23%">
                            <template lwc:if={isEditMode}>
                                <lightning-input type="text" name="Deal_Cycle__c" data-index={index}
                                    value={rec.Deal_Cycle__c} onchange={handleChange} max-length="255">
                                </lightning-input>
                            </template>
                            <template lwc:else>
                                <lightning-formatted-text style="word-wrap: break-word; white-space: normal;" value={rec.Deal_Cycle__c}></lightning-formatted-text>
                            </template>
                        </td>
                        <td  colspan="4">
                            <template lwc:if={isEditMode}>
                                <!--<lightning-input type="text" name="Red_Yellow_Green__c" value={rec.Red_Yellow_Green__c}
                                    data-index={index} onchange={handleChange} max-length="255">
                                </lightning-input>-->
                                 <lightning-combobox style="word-wrap: break-word; white-space: normal;" name="Status__c"  value={rec.Status__c}
                                    placeholder="Select Status" options={options} data-index={index}
                                    onchange={handleChange}></lightning-combobox>
                                    
                           
                            </template>
                            <template lwc:else>
                                <lightning-formatted-text style="word-wrap: break-word; white-space: normal;" value={rec.Status__c}></lightning-formatted-text>
                            </template>
                        </td>
                        <td class="slds-border_right" colspan="1">
                            <div class="slds-text-align_right">
                                <template lwc:if={isEditMode}>
                                    <template if:false={rec.isFixed}>
                                    <lightning-icon icon-name="action:delete" data-index={index}
                                        alternative-text="Delete this row" size="xx-small" title="Delete this row"
                                        onclick={removeAnticipatedRow}>
                                    </lightning-icon>
                                    </template>
                                </template>
                                <template lwc:else>
                                    <template if:false={rec.isFixed}>
                                    <lightning-icon icon-name="action:delete" alternative-text="Delete this row" size="xx-small"
                                        title="Delete this row" class="disabled-icon">
                                    </lightning-icon>
                                    </template>
                                </template>
                            </div>
                        </td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div>
    <div>
        <div class="section-header">
            <div class="slds-p-top_xx-small slds-p-left_x-small slds-text-heading_small slds-p-bottom_medium">
                <span><b>Additional Comments</b></span>
            </div>
        </div>
    </div>
    <!--<div class="slds-p-top_small  slds-text-align_right slds-text-heading_small">
        <template lwc:if={isEditMode}>
            <lightning-button label="Clear Data" variant="Neutral" alternative-text="Clear entire table" size="small"
                title="Clear entire table" onclick={deleteAllAnticipatedRows}>
            </lightning-button>
            <template if:true={showConfirmModalAnticipated}>
                <section role="dialog" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header" style="background-color: #ba0517; color: white;">
                            <h2 class="slds-text-heading_medium">Confirmation</h2>
                        </header>
                        <div class="slds-modal__content slds-p-around_medium">
                            Alert: This action will 
                             all data in the table. Are you sure you want to proceed?
                             <div style="text-align: center;" class="slds-p-top_large">
                            <lightning-button label="Continue" onclick={handleConfirmComments}>
                            </lightning-button>

                            <lightning-button label="Cancel" onclick={handleCancelDelete} class="slds-m-left_x-small">
                            </lightning-button>
                        </div>
                        </div>
                        
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </template>
        </template>
        <template lwc:else>

            <lightning-button label="Clear Data" variant="Neutral" disabled alternative-text="Clear entire table"
                size="small" title="Clear entire table" onclick={handleConfirmComments}>
            </lightning-button>
        </template>
    </div>-->
    <div class="slds-p-top_large slds-p-bottom_large">
        <template lwc:if={isEditMode}>
            <lightning-textarea type="text" class="slds-p-bottom_x-small slds-p-left_small slds-p-right_small"
                name="Additional_Comments__c" variant="label-hidden" value={ebdListData.Additional_Comments__c} onchange={handleInputChange}
                max-length="32768">
            </lightning-textarea>
        </template>
        <template lwc:else>
            <div class="slds-box" >
            <template lwc:if={ebdListData.Additional_Comments__c}>
                <lightning-formatted-text value={ebdListData.Additional_Comments__c}></lightning-formatted-text>
            </template>
            </div>
        </template>
    </div>
</template>